name: Run Tests

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  test-the-tests:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - run: ./test-tests
  test-migration-ubuntu:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: test migration
      shell: bash
      run: ./test-migration
  test-migration-macos:
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@v3
    - name: test migration
      shell: bash
      run: ./test-migration
  test-migration-windows:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v3
    - name: switch docker to linux mode
      #run: "& $Env:ProgramFiles\Docker\Docker\DockerCli.exe -SwitchDaemon ."
      run: "DockerCli.exe -SwitchDaemon ."
    - name: test migration
      shell: bash
      run: ./test-migration
